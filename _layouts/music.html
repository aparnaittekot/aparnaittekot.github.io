---
layout: page
# The Archives of music.
---

<style>
.music-vote-layout {
  display: block;
  margin: 2.5rem auto;
  max-width: 1200px;
  position: relative;
}
.music-vote-table-section {
  width: 100%;
  background: #23272f;
  border-radius: 16px;
  box-shadow: 0 2px 16px rgba(0,0,0,0.13);
  padding: 2.2rem 2rem 2.5rem 2rem;
  color: #fff;
  margin-bottom: 2.5rem;
}
.music-vote-form-section {
  max-width: 420px;
  margin: 0 auto;
  background: #23272f;
  border-radius: 16px;
  box-shadow: 0 2px 16px rgba(0,0,0,0.13);
  padding: 1.2rem 1rem 1.5rem 1rem;
  color: #fff;
}
.music-vote-title {
  font-size: 1.2em;
  font-weight: 700;
  margin-bottom: 1em;
  text-align: left;
}
.music-vote-table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 1.5rem;
}
.music-vote-table th, .music-vote-table td {
  padding: 0.7em 0.6em;
  border-bottom: 1px solid #333;
  text-align: left;
  font-size: 1em;
}
.music-vote-table th {
  color: #b3b3b3;
  font-weight: 700;
  background: #23272f;
}
.music-vote-table tr:last-child td {
  border-bottom: none;
}
.music-vote-table td {
  color: #fff;
  background: #181818;
}
.music-vote-form label {
  color: #fff;
  font-weight: 600;
  font-size: 1em;
  margin-bottom: 0.2em;
}
.music-vote-form input,
.music-vote-form select,
.music-vote-form textarea {
  padding: 0.5em 0.8em;
  border-radius: 7px;
  border: 1px solid #444;
  background: #181818;
  color: #fff;
  font-size: 0.98em;
  width: 100%;
  box-sizing: border-box;
  margin-bottom: 0.7em;
}
.music-vote-form textarea {
  resize: vertical;
}
.music-vote-form button {
  background: #1db954;
  color: #fff;
  font-weight: 700;
  font-size: 1em;
  padding: 0.6em 0;
  border: none;
  border-radius: 7px;
  transition: background 0.2s;
  cursor: pointer;
  margin-top: 0.3em;
  width: 100%;
}
.music-vote-status {
  min-height: 1.2em;
  font-size: 0.98em;
  color: #b3b3b3;
  margin-top: 0.2em;
  text-align: center;
}
.music-vote-popup-btn {
  position: static;
  margin: 1.2rem 0 1.2rem 0;
  display: block;
  background: #1db954;
  color: #fff;
  border: none;
  border-radius: 7px;
  padding: 0.7em 1.5em;
  font-weight: 700;
  font-size: 1em;
  cursor: pointer;
  z-index: 10;
  box-shadow: 0 2px 8px rgba(0,0,0,0.13);
  transition: background 0.2s;
}
.music-vote-popup-btn:hover {
  background: #15913e;
}
.music-vote-popup-overlay {
  display: none;
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  width: 100vw;
  height: 100vh;
  justify-content: center;
  align-items: center;
  z-index: 1000;
  background: rgba(0,0,0,0.45);
}
.music-vote-popup-overlay.active {
  display: flex;
}
.music-vote-popup-content {
  background: #23272f;
  border-radius: 16px;
  box-shadow: 0 2px 16px rgba(0,0,0,0.18);
  padding: 2.2rem 2rem 2.5rem 2rem;
  color: #fff;
  max-width: 420px;
  width: 95vw;
  position: relative;
  margin: 0;
  animation: popupIn 0.25s cubic-bezier(.4,2,.6,1);
  /* Centered by flexbox parent */
}
@keyframes popupIn {
  from { opacity: 0; transform: translateY(-40px);}
  to { opacity: 1; transform: translateY(0);}
}
.music-vote-popup-close {
  position: absolute;
  top: 1.1rem;
  right: 1.2rem;
  background: none;
  border: none;
  color: #fff;
  font-size: 1.5em;
  cursor: pointer;
  font-weight: 700;
  z-index: 1002;
}
@media (max-width: 900px) {
  .music-vote-layout {
    flex-direction: column;
    gap: 1.5rem;
  }
  .music-vote-table-section, .music-vote-form-section {
    max-width: 100%;
    min-width: 0;
    padding: 1.2rem 0.7rem 1.5rem 0.7rem;
  }
}
</style>

<div class="music-vote-layout">
  <button id="music-vote-popup-btn" class="music-vote-popup-btn" type="button">Suggest a Topic</button>
  <div id="music-vote-popup-overlay" class="music-vote-popup-overlay">
    <div class="music-vote-popup-content">
      <button class="music-vote-popup-close" id="music-vote-popup-close" title="Close">&times;</button>
      <div class="music-vote-title" style="text-align:center;">Suggest a Music Content Topic</div>
      <form id="music-vote-form" class="music-vote-form" autocomplete="off">
        <label for="topic">Content Topic</label>
        <input id="topic" name="topic" type="text" required placeholder="e.g. Circle of Fifths">

        <label for="contentType">Content Type</label>
        <select id="contentType" name="contentType" required>
          <option value="">Select</option>
          <option value="Music Theory">Music Theory</option>
          <option value="Music Cover">Music Cover</option>
        </select>

        <label for="resourceType">Resource Type</label>
        <select id="resourceType" name="resourceType" required>
          <option value="">Select</option>
          <option value="VIDEO">VIDEO</option>
          <option value="BLOG">BLOG</option>
        </select>

        <label for="instrument">Instrument</label>
        <select id="instrument" name="instrument" required>
          <option value="">Select</option>
          <option value="PIANO">PIANO</option>
          <option value="ACOUSTIC_GUITAR">ACOUSTIC_GUITAR</option>
          <option value="ELECTRIC_GUITAR">ELECTRIC_GUITAR</option>
        </select>

        <label for="description">Description</label>
        <textarea id="description" name="description" rows="3" required placeholder="Describe the topic..."></textarea>

        <button type="submit">Submit</button>
        <div id="music-vote-status" class="music-vote-status"></div>
      </form>
    </div>
  </div>
  <div class="music-vote-table-section">
    <!-- Button moved above table -->
    <table class="music-vote-table" id="music-vote-table">
      <thead>
        <tr>
          <th>Content Topic</th>
          <th>Content Type</th>
          <th>Resource Type</th>
          <th>Instrument</th>
          <th>Description</th>
          <th>Status</th>
          <th>Date</th>
        </tr>
      </thead>
      <tbody id="music-vote-table-body">
        <!-- JS will populate rows here -->
      </tbody>
    </table>
  </div>
</div>

<script>
// Notion API endpoints (backend proxy required)
const NOTION_API_WRITE = 'https://your-backend.example.com/api/music-content';
const NOTION_API_READ = 'https://your-backend.example.com/api/music-content/list';

// Render table rows
function renderMusicVoteTable(topics) {
  const tbody = document.getElementById('music-vote-table-body');
  tbody.innerHTML = '';
  if (!topics.length) {
    tbody.innerHTML = '<tr><td colspan="7" style="color:#b3b3b3;text-align:center;">No topics yet.</td></tr>';
    return;
  }
  topics.forEach(row => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${row.topic || ''}</td>
      <td>${row.contentType || ''}</td>
      <td>${row.resourceType || ''}</td>
      <td>${row.instrument || ''}</td>
      <td>${row.description || ''}</td>
      <td>${row.status || ''}</td>
      <td>${row.date ? row.date.split('T')[0] : ''}</td>
    `;
    tbody.appendChild(tr);
  });
}

// Fetch topics from Notion (via backend)
async function fetchMusicTopics() {
  try {
    const resp = await fetch(NOTION_API_READ);
    if (!resp.ok) return [];
    return await resp.json();
  } catch {
    return [];
  }
}

// Popup logic
const popupBtn = document.getElementById('music-vote-popup-btn');
const popupOverlay = document.getElementById('music-vote-popup-overlay');
const popupClose = document.getElementById('music-vote-popup-close');

popupBtn.addEventListener('click', function() {
  popupOverlay.classList.add('active');
  setTimeout(() => {
    document.getElementById('topic').focus();
  }, 200);
});
popupClose.addEventListener('click', function() {
  popupOverlay.classList.remove('active');
});
popupOverlay.addEventListener('click', function(e) {
  if (e.target === popupOverlay) popupOverlay.classList.remove('active');
});

// Handle form submission
document.getElementById('music-vote-form').addEventListener('submit', async function(e) {
  e.preventDefault();
  const statusDiv = document.getElementById('music-vote-status');
  statusDiv.textContent = 'Submitting...';

  const data = {
    topic: document.getElementById('topic').value.trim(),
    contentType: document.getElementById('contentType').value,
    resourceType: document.getElementById('resourceType').value,
    instrument: document.getElementById('instrument').value,
    description: document.getElementById('description').value.trim()
    // status, date, link removed from form submission
  };

  try {
    const resp = await fetch(NOTION_API_WRITE, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data)
    });
    if (resp.ok) {
      statusDiv.textContent = 'Thank you! Your suggestion was submitted.';
      this.reset();
      setTimeout(() => { statusDiv.textContent = ''; }, 2000);
      setTimeout(loadMusicTopics, 800);
      popupOverlay.classList.remove('active');
    } else {
      statusDiv.textContent = 'Failed to submit. Please try again later.';
    }
  } catch {
    statusDiv.textContent = 'Failed to submit. Please try again later.';
  }
});

// Load and render topics
async function loadMusicTopics() {
  const topics = await fetchMusicTopics();
  renderMusicVoteTable(topics);
}
document.addEventListener('DOMContentLoaded', loadMusicTopics);
</script>
